<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- manual page source format generated by PolyglotMan v3.0.8+X.Org, -->
<!-- available at http://polyglotman.sourceforge.net/ -->
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<meta name='Author' content='ActiveState'>
<link rel='stylesheet' type='text/css' href='../aspn.css'>
<title>TDBC tdbc_resultset</title>
</head>
<body>
<div class="banner">
<table width="100%" border="0" cellspacing="0" cellpadding="3">
<tr>
<td align="left"><a target="_blank" href=
"http://www.activestate.com/activetcl"><img src=
"../images/ActiveTcl.gif" border="0" align="left" alt="ActiveTcl">
</a> </td>
<td align="center" class="heading">ActiveTcl User Guide</td>
<td align="right"><a target="_blank" href=
"http://www.activestate.com"><img src="../images/AS_logo.gif"
border="0" align="right" alt="ActiveState Software Inc."></a> </td>
</tr>
</table>
</div>

<br>
<a href='#toc'>Table of Contents</a> 

<p>
______________________________________________________________________________</p>

<h2><a name='sect0' href='#toc0'><b>Name</b></a></h2>

<p>tdbc::resultset - TDBC result set object</p>

<h2><a name='sect1' href='#toc1'><b>Synopsis</b></a></h2>

<p>package require <b>tdbc</b> <b>1.0</b><br>
 package require <b>tdbc::</b><i>driver</i> <i>version</i></p>

<p><b>tdbc::</b><i>driver</i><b>::connection</b> <b>create</b>
<i>db</i> <i>?-option</i> <i>value</i>...?</p>

<p><b>set</b> <i>stmt</i> <b>[</b><i>db</i> <b>prepare</b>
<i>sql-code</i><b>]</b><br>
 <b>set</b> <i>resultset</i> <b>[</b><i>$stmt</i> <b>execute</b>
?<i>args...</i>?<b>]</b></p>

<p><i>$resultset</i> <b>columns</b><br>
 <i>$resultset</i> <b>rowcount</b><br>
 <i>$resultset</i> <b>nextrow</b> ?<b>-as</b>
<b>lists</b>|<b>dicts</b>? ?<b>--</b>? <i>varname</i>
<i>$resultset</i> <b>nextlist</b> <i>varname</i><br>
 <i>$resultset</i> <b>nextdict</b> <i>varname</i><br>
 <i>$resultset</i> <b>nextresults</b><br>
 <i>$resultset</i> <b>allrows</b> ?<b>-as</b> <b>lists|dicts</b>?
?<b>-columnsvariable</b> <i>name</i>? ?<b>--</b>? <i>$resultset</i>
<b>foreach</b> ?<b>-as</b> <b>lists|dicts</b>?
?<b>-columnsvariable</b> <i>name</i>? ?<b>--</b>? <i>var-name</i>
<i>script</i> <i>$resultset</i> <b>close</b><br>
 _________________________________________________________________</p>

<h2><a name='sect2' href='#toc2'><b>Description</b></a></h2>

<p>Every database driver for TDBC (Tcl DataBase Connectivity)
implements a <i>result</i> <i>set</i> object that represents a the
results returned from executing SQL statement in a database.
Instances of this object are created by executing the
<b>execute</b> object command on a statement object.</p>

<p>The <b>columns</b> obect command returns a list of the names of
the columns in the result set. The columns will appear in the same
order as they appeared in the SQL statement that performed the
database query. If the SQL statement does not return a set of
columns (for instance, if it is an INSERT, UPDATE, or DELETE
statement), the <b>columns</b> command will return an empty
list.</p>

<p>The <b>rowcount</b> object command returns the number of rows in
the database that were affected by the execution of an INSERT,
UPDATE or DELETE statement. For a SELECT statement, the row count
is unspecified.</p>

<p>The <b>nextlist</b> object command sets the variable given by
<i>varname</i> in the caller&acirc;&euro;&trade;s scope to the next
row of the results, expressed as a list of column values. NULL
values are replaced by empty strings. The columns of the result row
appear in the same order in which they appeared on the SELECT
statement. The return of <b>nextlist</b> is <b>1</b> if the
operation suc-ceeded, and <b>0</b> if the end of the result set was
reached.</p>

<p>The <b>nextdict</b> object command sets the variable given by
<i>varname</i> in the caller&acirc;&euro;&trade;s scope to the next
row of the results, expressed as a dictio-nary. The
dictionary&acirc;&euro;&trade;s keys are column names, and the
values are the values of those columns in the row. If a
column&acirc;&euro;&trade;s value in the row is NULL, its key is
omitted from the dictionary. The keys appear in the dictionary in
the same order in which the columns appeared on the SELECT
statement. The return of <b>nextdict</b> is <b>1</b> if the
operation suc-ceeded, and <b>0</b> if the end of the result set was
reached.</p>

<p>The <b>nextrow</b> object command is precisely equivalent to the
<b>nextdict</b> or <b>nextlist</b> object command, depending on
whether <b>-as</b> <b>dicts</b> (the default) or <b>-as</b>
<b>lists</b> is specified.</p>

<p>Some databases support the idea of a single statement that
returns mul-tiple sets of results. The <b>nextresults</b> object
command is executed, typ-ically after the <b>nextlist</b> of
<b>nextdict</b> object command has returned <b>0</b>, to advance to
the next result set. It returns <b>1</b> if there is another result
set to process, and <b>0</b> if the result set just processed was
the last. After calling <b>nextresults</b> and getting the return
value of <b>1</b>, the caller may once again call <b>columns</b> to
get the column descriptions of the next result set, and then return
to calling <b>nextdict</b> or <b>nextlist</b> to process the rows
of the next result set. It is an error to call <b>columns</b>,
<b>next-dict</b>, <b>nextlist</b> or <b>nextrow</b> after
<b>nextresults</b> has returned <b>0</b>.</p>

<p>The <b>allrows</b> object command sets the variable designated
by the <b>-columnsvariable</b> option (if present) to the result of
the <b>columns</b> object command. It then executes the
<b>nextrow</b> object command repeatedly until the end of the
result set is reached. If <b>nextresults</b> returns a nonzero
value, it executes the above two steps (<b>columns</b> followed by
iterated <b>nextrow</b> calls) as long as further results are
available. The rows returned by <b>nextrow</b> are assembled into a
Tcl list and become the return value of the <b>allrows</b> command;
the last value returned from <b>columns</b> is what the application
will see in <b>-columnsvariable</b>.</p>

<p>The <b>foreach</b> object command sets the variable designated
by the <b>-columnsvariable</b> option (if present) to the result of
the <b>columns</b> object command. It then executes the
<b>nextrow</b> object command repeatedly until the end of the
result set is reached, storing the successive rows in the variable
designated by <i>varName</i>. For each row, it executes the given
<i>script</i>. If the script terminates with an error, the error is
reported by the <b>foreach</b> command, and iteration stops. If the
script performs a <b>break</b> operation, the iteration terminates
prematurely. If the script performs a <b>continue</b> operation,
the iteration recommences with the next row. If the script performs
a <b>return</b>, results are the same as if a script outside the
control of <b>foreach</b> had returned. Any other unusual return
code terminates the iteration and is reported from the
<b>foreach</b>.</p>

<p>Once <b>nextrow</b> returns <b>0</b>, the <b>foreach</b> object
command tries to advance to the next result set using
<b>nextresults</b>. If <b>nextresults</b> returns <b>1</b>, the
above steps (<b>columns</b> and <b>nextrow</b>, with script
invocation) are repeated as long as more result sets remain. The
<i>script</i> will always see the cor-rect description of the
columns of the current result set in the vari-able designated byt
<b>-columnsvariable</b>. At the end of the call, the vari-able
designated by <b>-columnsvariable</b> will have the description of
the columns of the last result set.</p>

<p>The <b>close</b> object command deletes the result set and frees
any associ-ated system resources.</p>

<h2><a name='sect3' href='#toc3'><b>See</b> <b>Also</b></a></h2>

<p><a href='encoding.n.html'>encoding(n)</a> , <a href=
'tdbc.n.html'>tdbc(n)</a> , <a href=
'tdbc::connection.n.html'>tdbc::connection(n)</a> , <a href=
'tdbc::statement.n.html'>tdbc::statement(n)</a> , <a href=
'tdbc::tokenize.n.html'>tdbc::tokenize(n)</a></p>

<h2><a name='sect4' href='#toc4'><b>Keywords</b></a></h2>

<p>TDBC, SQL, database, connectivity, connection, resultset,
statement, bound variable, stored procedure, call</p>

<h2><a name='sect5' href='#toc5'><b>Copyright</b></a></h2>

<p>Copyright (c) 2008 by Kevin B. Kenny.</p>

<h2><a name='sect6' href='#toc6'>Tcl 8.6 <a href=
'tdbc::resultset.n.html'>tdbc::resultset(n)</a></a></h2>

<hr>
<p><a name='toc'><b>Table of Contents</b></a></p>

<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>

<li><a name='toc1' href='#sect1'>Synopsis</a></li>

<li><a name='toc2' href='#sect2'>Description</a></li>

<li><a name='toc3' href='#sect3'>See Also</a></li>

<li><a name='toc4' href='#sect4'>Keywords</a></li>

<li><a name='toc5' href='#sect5'>Copyright</a></li>

<li><a name='toc6' href='#sect6'>Tcl 8.6
tdbc::resultset(n)</a></li>
</ul>
</body>
</html>

